From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: etil2jz <blanchot.arthur@protonmail.ch>
Date: Sat, 19 Mar 2022 16:27:30 +0100
Subject: [PATCH] PaperPR Add more collision code skipping logic

Taken from https://github.com/PaperMC/Paper/pull/7581

diff --git a/src/main/java/net/minecraft/world/entity/LivingEntity.java b/src/main/java/net/minecraft/world/entity/LivingEntity.java
index 8de704cb857b89caeca1bd9d33b80d74211fd04c..d8b5f621b5af8f8e2c90f177e8f1e39bbcd96cbc 100644
--- a/src/main/java/net/minecraft/world/entity/LivingEntity.java
+++ b/src/main/java/net/minecraft/world/entity/LivingEntity.java
@@ -3509,6 +3509,10 @@ public abstract class LivingEntity extends Entity {
 
     protected void pushEntities() {
         // Paper start - don't run getEntities if we're not going to use its result
+        if (!isCollidable(level.paperConfig.fixClimbingBypassingCrammingRule)) return;
+        net.minecraft.world.scores.Team team = getTeam();
+        if (team != null && team.getCollisionRule() == net.minecraft.world.scores.Team.CollisionRule.NEVER) return;
+
         int i = this.level.getGameRules().getInt(GameRules.RULE_MAX_ENTITY_CRAMMING);
         if (i <= 0 && level.paperConfig.maxCollisionsPerEntity <= 0) {
             return;
